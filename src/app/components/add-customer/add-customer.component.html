<div class="add-customer-container">
  <h2 class="form-title">Add New Customer</h2>

  <form #customerForm="ngForm">
    <!-- First Name -->
    <mat-form-field appearance="outline">
      <mat-label>First Name</mat-label>
      <input
        matInput
        type="text"
        [(ngModel)]="customer.firstname"
        name="firstname"
        required
      />
    </mat-form-field>

    <!-- Last Name -->
    <mat-form-field appearance="outline">
      <mat-label>Last Name</mat-label>
      <input
        matInput
        type="text"
        [(ngModel)]="customer.lastname"
        name="lastname"
        required
      />
    </mat-form-field>

    <!-- Phone Number -->
    <mat-form-field appearance="outline">
      <mat-label>Phone Number</mat-label>
      <input
        matInput
        type="tel"
        [(ngModel)]="customer.phoneNumber"
        name="phoneNumber"
        required
      />
    </mat-form-field>

    <!-- National ID -->
    <mat-form-field appearance="outline">
      <mat-label>National ID</mat-label>
      <input
        matInput
        type="text"
        [(ngModel)]="customer.nationalIdentityCard"
        name="nationalIdentityCard"
        required
      />
    </mat-form-field>

    <!-- Attach Loan Toggle -->
    <mat-slide-toggle [(ngModel)]="attachLoan" name="attachLoan"
      >Attach Loan?</mat-slide-toggle
    >

    <!-- Loan Fields (conditionally displayed) -->
    <div *ngIf="attachLoan" class="loan-form">
      <h3 class="section-title">Loan Details</h3>

      <!-- Principal Amount -->
      <mat-form-field appearance="outline">
        <mat-label>Principal Amount</mat-label>
        <input
          matInput
          type="number"
          [(ngModel)]="loan.principalAmount"
          name="principalAmount"
          required
          min="1"
        />
      </mat-form-field>

      <!-- Interest Rate -->
      <mat-form-field appearance="outline">
        <mat-label>Interest Rate (%)</mat-label>
        <input
          matInput
          type="number"
          [(ngModel)]="loan.interestRate"
          name="interestRate"
          required
          min="0"
          step="0.01"
        />
      </mat-form-field>

      <!-- Repayment Period (in months or weeks) -->
      <mat-form-field appearance="outline">
        <mat-label>Repayment Period (months)</mat-label>
        <input
          matInput
          type="number"
          [(ngModel)]="loan.repaymentPeriod"
          name="repaymentPeriod"
          required
          min="1"
        />
      </mat-form-field>

      <!-- Due Date -->
<mat-form-field appearance="outline" class="date-picker-field">
  <mat-label>Due Date</mat-label>
  <input
    matInput
    [matDatepicker]="dueDatePicker"
    [(ngModel)]="loan.dueDate"
    name="dueDate"
    required
    placeholder="Select due date"
  />
  <mat-datepicker-toggle matSuffix [for]="dueDatePicker"></mat-datepicker-toggle>
  <mat-datepicker #dueDatePicker></mat-datepicker>
</mat-form-field>


      <!-- Loan Status -->
      <mat-form-field appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select [(ngModel)]="loan.status" name="status" required>
          <mat-option value="PENDING">Pending</mat-option>
          <mat-option value="APPROVED">Approved</mat-option>
          <mat-option value="REJECTED">Rejected</mat-option>
          <mat-option value="DISBURSED">Disbursed</mat-option>
          <mat-option value="IN_REPAYMENT">In Repayment</mat-option>
          <mat-option value="PAID">Paid</mat-option>
          <mat-option value="DEFAULTED">Defaulted</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Attach Loan Button -->
    <button
      mat-raised-button
      class="attach-loan-btn"
      (click)="toggleAttachLoan()"
      type="button"
    >
      Attach Loan
    </button>

    <!-- Submit and Cancel Buttons -->
    <div class="button-container">
      <button
        mat-raised-button
        class="submit-btn"
        type="submit"
        (click)="onSubmit(customerForm)"
      >
        Submit
      </button>
      <button
        mat-raised-button
        class="cancel-btn"
        type="button"
        (click)="onCancel()"
      >
        Cancel
      </button>
    </div>
  </form>
</div>
